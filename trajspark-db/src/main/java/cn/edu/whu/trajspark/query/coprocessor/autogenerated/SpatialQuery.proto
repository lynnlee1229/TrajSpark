syntax = "proto2";

option java_package = "cn.edu.whu.trajspark.query.coprocessor.autogenerated";
option java_outer_classname = "BasicSTQueryCoprocessor";
option java_generic_services = true;
option java_generate_equals_and_hash = true;
option optimize_for = SPEED;

enum QueryType {
  CONTAIN = 0;
  INTERSECT = 1;
}

message Range {
  required bytes start = 1;
  required bytes end = 2;
}

message SpatialQueryWindow {
  required string wkt = 1;
}

message TemporalQueryWindow {
  required int64 startMs = 1;
  required int64 endMs = 2;
}


message QueryRequest {
  repeated Range range = 1;
  optional QueryType spatialQueryType = 2;
  optional SpatialQueryWindow spatialQueryWindow = 3;
  optional QueryType temporalQueryType = 4;
  optional TemporalQueryWindow temporalQueryWindow = 5;
}

message QueryResponse {
  repeated TrajectoryResult list = 1;
}

message TrajectoryResult {
  required bytes rowkey = 1;
  required bytes trajPointList = 2;
  required bytes objectId = 3;
}

service QueryService {
  rpc query(QueryRequest)
      returns (QueryResponse);
}